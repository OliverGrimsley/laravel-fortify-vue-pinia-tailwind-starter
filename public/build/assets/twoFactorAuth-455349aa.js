import{d as g,u as x,r as w,m as A,e as o,o as s,c as d,f as t,j as a,i as l,g as _,w as f,F as h,n as k,t as i}from"./app-4efa1d98.js";import{_ as F}from"./textInput.vue_vue_type_script_setup_true_lang-e1740d91.js";const C={key:0},V={key:0},$={key:0},E=t("div",{class:"mb-4"},[l(" You have not enabled two factor authentication, did you want to? "),t("br"),l(" You will need to have a 2FA application available on a mobile device that can scan a QR code. We recommend "),t("a",{class:"text-blue-500 underline",href:"https://authy.com/guides/twilio/",target:"_blank"},"Authy"),l("."),t("br"),l(" You will also be requried to confirm your password when you click on the Enable 2FA link below ")],-1),N={key:1},P=["innerHTML"],R=t("button",{class:"rounded-md border border-blue-600 bg-blue-600 px-2 text-white"},"Confirm code",-1),S={key:0},T=t("div",null,"Please copy your recovery codes in case you lose access to your 2FA app:",-1),q={class:"font-mono"},Y={key:1},B=t("button",{class:"rounded-md border border-blue-600 bg-blue-600 px-2 text-white"},"Confirm Password",-1),L={key:2},M={key:1},D=t("div",null,"Recovery codes:",-1),H={class:"font-mono"},Q={key:3},W=g({__name:"twoFactorAuth",setup(U){const e=x(),u=w(""),c=w(""),v=A(()=>{var b;return!!((b=e.user)!=null&&b.two_factor_confirmed_at)});return(b,r)=>{var p,y;return o(e).loggedIn?(s(),d("div",C,[v.value?a("",!0):(s(),d("div",V,[!o(e).passwordNeedsConfirm&&!o(e).qrcode?(s(),d("div",$,[E,t("div",null,[t("button",{class:"rounded-md border border-blue-600 bg-blue-600 px-2 text-white",onClick:r[0]||(r[0]=n=>o(e).enableTwoFactor())},"Enable 2FA")])])):a("",!0),o(e).qrcode?(s(),d("div",N,[l(" Please complete the following steps to finish 2FA - use your 2FA app, scan the below QR code, and enter the code it gives you: "),t("div",{class:"mt-4",innerHTML:o(e).qrcode},null,8,P),t("form",{onSubmit:r[2]||(r[2]=f(n=>o(e).confirmTwoFactor(c.value),["prevent"]))},[l(" Enter code: "),_(F,{modelValue:c.value,"onUpdate:modelValue":r[1]||(r[1]=n=>c.value=n),label:"Enter passcode from your 2FA App",type:"text"},null,8,["modelValue"]),R],32),o(e).recoverycodes?(s(),d("div",S,[T,(s(!0),d(h,null,k(o(e).recoverycodes,(n,m)=>(s(),d("div",null,[l(i(m+1)+". ",1),t("span",q,i(n),1)]))),256))])):a("",!0)])):a("",!0),(p=o(e).user)!=null&&p.two_factor_confirmed_at?(s(),d("div",{key:2,onClick:r[3]||(r[3]=n=>o(e).get2FARecoveryCodes()),class:"rounded-md border bg-blue-500 px-2 text-white"}," Show recovery codes? ")):a("",!0)])),o(e).passwordNeedsConfirm?(s(),d("div",Y,[l(" Please confirm your password: "),t("form",{onSubmit:r[5]||(r[5]=f(n=>o(e).confirmPassword(u.value,"show2FARecoveryCodes"),["prevent"]))},[_(F,{modelValue:u.value,"onUpdate:modelValue":r[4]||(r[4]=n=>u.value=n),type:"password",label:"Confirm Password"},null,8,["modelValue"]),B],32)])):a("",!0),(y=o(e).user)!=null&&y.two_factor_confirmed_at?(s(),d("div",L,[o(e).recoverycodes?a("",!0):(s(),d("div",{key:0,onClick:r[6]||(r[6]=n=>o(e).get2FARecoveryCodes()),class:"cursor-pointer rounded-md border bg-blue-500 px-2 text-white"}," Show recovery codes? ")),o(e).recoverycodes?(s(),d("div",M,[D,(s(!0),d(h,null,k(o(e).recoverycodes,(n,m)=>(s(),d("div",null,[l(i(m+1)+". ",1),t("span",H,i(n),1)]))),256))])):a("",!0)])):a("",!0),v.value?(s(),d("div",Q,[l(" You have enabled two factor authentication, did you want to disable it? "),t("div",null,[t("button",{class:"rounded-md border border-blue-600 bg-blue-600 px-2 text-white",onClick:r[7]||(r[7]=n=>o(e).disableTwoFactor())},"Disable 2FA")])])):a("",!0)])):a("",!0)}}});export{W as default};
