import{d as x,u as A,r as w,m as C,e as o,o as r,c as d,f as t,j as a,i as l,g as f,w as h,F as g,n as k,t as i}from"./app-dddd4061.js";import{_ as F}from"./textInput.vue_vue_type_script_setup_true_lang-2dece68f.js";const V={key:0},R={key:0},$={key:0},E=t("div",{class:"mb-4"},[l(" You have not enabled two factor authentication, did you want to? "),t("br"),l(" You will need to have a 2FA application available on a mobile device that can scan a QR code. We recommend "),t("a",{class:"text-blue-500 underline",href:"https://authy.com/guides/twilio/",target:"_blank"},"Authy"),l("."),t("br"),l(" You will also be requried to confirm your password when you click on the Enable 2FA link below ")],-1),N={key:1},P=["innerHTML"],T=t("button",{class:"rounded-md border border-blue-600 bg-blue-600 px-2 text-white"},"Confirm code",-1),q={key:0},S=t("div",null,"Please copy your recovery codes in case you lose access to your 2FA app:",-1),Y={class:"font-mono"},B={key:1,class:"mb-4"},L=t("button",{class:"rounded-md border border-blue-600 bg-blue-600 px-2 text-white"},"Confirm Password",-1),M={key:2},D={key:1},H=t("div",null,"Recovery codes:",-1),Q={class:"font-mono"},U={key:3,class:"mt-4"},j=t("div",{class:"mb-4"},"You have enabled two factor authentication, did you want to disable it?",-1),G=x({__name:"twoFactorAuth",setup(I){const e=A(),u=w(""),c=w(""),b=C(()=>{var m;return!!((m=e.user)!=null&&m.two_factor_confirmed_at)});return(m,s)=>{var p,y,_;return o(e).loggedIn?(r(),d("div",V,[b.value?a("",!0):(r(),d("div",R,[!o(e).passwordNeedsConfirm&&!o(e).qrcode?(r(),d("div",$,[E,t("div",null,[t("button",{class:"rounded-md border border-blue-600 bg-blue-600 px-2 text-white",onClick:s[0]||(s[0]=n=>o(e).enableTwoFactor())},"Enable 2FA")])])):a("",!0),o(e).qrcode?(r(),d("div",N,[l(" Please complete the following steps to finish 2FA - use your 2FA app, scan the below QR code, and enter the code it gives you: "),t("div",{class:"mt-4",innerHTML:o(e).qrcode},null,8,P),t("form",{onSubmit:s[2]||(s[2]=h(n=>o(e).confirmTwoFactor(c.value),["prevent"]))},[l(" Enter code: "),f(F,{modelValue:c.value,"onUpdate:modelValue":s[1]||(s[1]=n=>c.value=n),label:"Enter passcode from your 2FA App",type:"text"},null,8,["modelValue"]),T],32),o(e).recoverycodes?(r(),d("div",q,[S,(r(!0),d(g,null,k(o(e).recoverycodes,(n,v)=>(r(),d("div",null,[l(i(v+1)+". ",1),t("span",Y,i(n),1)]))),256))])):a("",!0)])):a("",!0),(p=o(e).user)!=null&&p.two_factor_confirmed_at?(r(),d("div",{key:2,onClick:s[3]||(s[3]=n=>o(e).get2FARecoveryCodes()),class:"rounded-md border bg-blue-500 px-2 text-white"}," Show recovery codes? ")):a("",!0)])),o(e).passwordNeedsConfirm?(r(),d("div",B,[l(" Please confirm your password: "),t("form",{onSubmit:s[5]||(s[5]=h(n=>o(e).confirmPassword(u.value,"show2FARecoveryCodes"),["prevent"]))},[f(F,{modelValue:u.value,"onUpdate:modelValue":s[4]||(s[4]=n=>u.value=n),type:"password",label:"Confirm Password"},null,8,["modelValue"]),L],32)])):a("",!0),(y=o(e).user)!=null&&y.two_factor_confirmed_at?(r(),d("div",M,[o(e).recoverycodes&&o(e).recoverycodes.length===0?(r(),d("div",{key:0,onClick:s[6]||(s[6]=n=>o(e).get2FARecoveryCodes()),class:"mb-4 w-1/2 cursor-pointer rounded-md border bg-slate-500 px-2 text-white"}," Regenerate recovery codes? ")):a("",!0),o(e).recoverycodes&&((_=o(e).recoverycodes)==null?void 0:_.length)>0?(r(),d("div",D,[H,(r(!0),d(g,null,k(o(e).recoverycodes,(n,v)=>(r(),d("div",null,[l(i(v+1)+". ",1),t("span",Q,i(n),1)]))),256))])):a("",!0)])):a("",!0),b.value?(r(),d("div",U,[j,t("div",null,[t("button",{class:"rounded-md border border-blue-600 bg-blue-600 px-2 text-white",onClick:s[7]||(s[7]=n=>o(e).disableTwoFactor())},"Disable 2FA")])])):a("",!0)])):a("",!0)}}});export{G as default};
